"""
Sentiment Analysis Flow Diagram
Minh há»a quy trÃ¬nh phÃ¢n tÃ­ch cáº£m tÃ­nh tá»« tin tá»©c Ä‘áº¿n database
"""

def print_flow_diagram():
    """Print visual flow diagram for Sentiment Analysis"""
    
    diagram = """
â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—
â•‘                    SENTIMENT ANALYSIS WORKFLOW - CHI TIáº¾T                    â•‘
â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ PHASE 1: THU THáº¬P TIN Tá»¨C (Data Collection)                                â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

    ðŸ“¡ RSS Feeds                    ðŸ’¾ Database
    â”œâ”€ CafeF RSS                   â”œâ”€ news_articles table
    â”œâ”€ VnExpress RSS               â”‚  â”œâ”€ symbol
    â””â”€ Ndh.vn RSS                  â”‚  â”œâ”€ title
                                   â”‚  â”œâ”€ summary
           â”‚                       â”‚  â”œâ”€ content
           â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€ published_at
                     â”‚
                     â–¼
            â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
            â”‚  NewsFetcher   â”‚  â† scripts/analyze_news_finbert.py
            â”‚  fetch_all()   â”‚
            â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                     â”‚
                     â”‚ Output: List[Dict]
                     â”‚ [
                     â”‚   {
                     â”‚     'symbol': 'VNM',
                     â”‚     'title': 'Vinamilk bÃ¡o lÃ£i tÄƒng 25%',
                     â”‚     'summary': 'CÃ´ng ty ...',
                     â”‚     'published_at': datetime(...)
                     â”‚   },
                     â”‚   ...
                     â”‚ ]
                     â–¼

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ PHASE 2: PHÃ‚N TÃCH Cáº¢M TÃNH (Sentiment Analysis)                           â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

                     â”‚
                     â–¼
    â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—
    â•‘   PHOBERT VIETNAMESE SENTIMENT        â•‘
    â•‘   wonrax/phobert-base-vietnamese-     â•‘
    â•‘   sentiment                           â•‘
    â• â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•£
    â•‘                                       â•‘
    â•‘  Input: Text (tiáº¿ng Viá»‡t)            â•‘
    â•‘  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â•‘
    â•‘  â”‚ "Vinamilk bÃ¡o lÃ£i tÄƒng 25%"     â”‚ â•‘
    â•‘  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â•‘
    â•‘           â”‚                          â•‘
    â•‘           â–¼                          â•‘
    â•‘  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â•‘
    â•‘  â”‚  1. Tokenization (PhoBERT)      â”‚ â•‘
    â•‘  â”‚     - TÃ¡ch tá»« tiáº¿ng Viá»‡t        â”‚ â•‘
    â•‘  â”‚     - Max 256 tokens            â”‚ â•‘
    â•‘  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â•‘
    â•‘           â”‚                          â•‘
    â•‘           â–¼                          â•‘
    â•‘  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â•‘
    â•‘  â”‚  2. BERT Encoding               â”‚ â•‘
    â•‘  â”‚     - Contextual embeddings     â”‚ â•‘
    â•‘  â”‚     - 768-dim vectors           â”‚ â•‘
    â•‘  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â•‘
    â•‘           â”‚                          â•‘
    â•‘           â–¼                          â•‘
    â•‘  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â•‘
    â•‘  â”‚  3. Classification Head         â”‚ â•‘
    â•‘  â”‚     - 3 classes: POS/NEG/NEU    â”‚ â•‘
    â•‘  â”‚     - Softmax probabilities     â”‚ â•‘
    â•‘  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â•‘
    â•‘           â”‚                          â•‘
    â•‘           â–¼                          â•‘
    â•‘  Output: Probabilities              â•‘
    â•‘  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â•‘
    â•‘  â”‚ Positive: 0.89  (89%)           â”‚ â•‘
    â•‘  â”‚ Negative: 0.05  (5%)            â”‚ â•‘
    â•‘  â”‚ Neutral:  0.06  (6%)            â”‚ â•‘
    â•‘  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â•‘
    â•‘           â”‚                          â•‘
    â•‘           â–¼                          â•‘
    â•‘  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â•‘
    â•‘  â”‚ Calculate Sentiment Score       â”‚ â•‘
    â•‘  â”‚ score = pos - neg               â”‚ â•‘
    â•‘  â”‚ score = 0.89 - 0.05 = +0.84     â”‚ â•‘
    â•‘  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â•‘
    â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
                     â”‚
                     â”‚ Output: Dict
                     â”‚ {
                     â”‚   'sentiment': 'positive',
                     â”‚   'score': 0.84,
                     â”‚   'positive': 0.89,
                     â”‚   'negative': 0.05,
                     â”‚   'neutral': 0.06
                     â”‚ }
                     â–¼

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ PHASE 3: LÆ¯U TRá»® (Save to Database)                                        â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

                     â”‚
                     â–¼
    â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—
    â•‘             DATABASE TABLE: analyzed_news                  â•‘
    â• â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•£
    â•‘ id | symbol | title          | sentiment | sentiment_score â•‘
    â•‘â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•‘
    â•‘ 1  â”‚ VNM    â”‚ Vinamilk bÃ¡o..â”‚ positive  â”‚ +0.84           â•‘
    â•‘ 2  â”‚ HPG    â”‚ HPG sá»¥t giáº£m..â”‚ negative  â”‚ -0.62           â•‘
    â•‘ 3  â”‚ VCB    â”‚ VCB á»•n Ä‘á»‹nh..â”‚ neutral   â”‚ +0.05           â•‘
    â• â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•£
    â•‘ Columns:                                                   â•‘
    â•‘  â€¢ id: Primary key                                         â•‘
    â•‘  â€¢ symbol: MÃ£ cá»• phiáº¿u (VNM, HPG, VCB, ...)              â•‘
    â•‘  â€¢ title: TiÃªu Ä‘á» tin tá»©c                                 â•‘
    â•‘  â€¢ summary: TÃ³m táº¯t ná»™i dung                              â•‘
    â•‘  â€¢ sentiment: positive/negative/neutral                    â•‘
    â•‘  â€¢ sentiment_score: -1.0 Ä‘áº¿n +1.0                         â•‘
    â•‘  â€¢ positive_score: XÃ¡c suáº¥t positive (0-1)                â•‘
    â•‘  â€¢ negative_score: XÃ¡c suáº¥t negative (0-1)                â•‘
    â•‘  â€¢ neutral_score: XÃ¡c suáº¥t neutral (0-1)                  â•‘
    â•‘  â€¢ published_at: NgÃ y xuáº¥t báº£n tin                        â•‘
    â•‘  â€¢ analyzed_at: NgÃ y phÃ¢n tÃ­ch                            â•‘
    â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
                     â”‚
                     â–¼

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ PHASE 4: Tá»”NG Há»¢P THEO NGÃ€Y (Daily Aggregation)                            â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

    VÃ­ dá»¥: Tá»•ng há»£p sentiment cho VNM ngÃ y 15/11/2024
    
    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    â”‚ Tin tá»©c VNM ngÃ y 15/11/2024:                                â”‚
    â”‚                                                              â”‚
    â”‚ ðŸ“ˆ Tin 1: "VNM tÄƒng trÆ°á»Ÿng máº¡nh"      â†’ +0.78 (positive)   â”‚
    â”‚ ðŸ“ˆ Tin 2: "Vinamilk má»Ÿ rá»™ng thá»‹ trÆ°á»ng"â†’ +0.65 (positive)  â”‚
    â”‚ ðŸ“ˆ Tin 3: "VNM bÃ¡o lÃ£i cao"           â†’ +0.82 (positive)   â”‚
    â”‚ ðŸ“ˆ Tin 4: "Sá»¯a VNM bÃ¡n cháº¡y"          â†’ +0.55 (positive)   â”‚
    â”‚ ðŸ“ˆ Tin 5: "VNM tÄƒng giÃ¡ cá»• phiáº¿u"     â†’ +0.70 (positive)   â”‚
    â”‚ ðŸ“‰ Tin 6: "VNM giáº£m sáº£n lÆ°á»£ng"        â†’ -0.42 (negative)   â”‚
    â”‚ âž¡ï¸  Tin 7: "VNM há»p cá»• Ä‘Ã´ng"          â†’ +0.05 (neutral)    â”‚
    â”‚ âž¡ï¸  Tin 8: "VNM cÃ´ng bá»‘ bÃ¡o cÃ¡o"      â†’ -0.10 (neutral)    â”‚
    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                     â”‚
                     â–¼
    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    â”‚ TÃNH TOÃN:                                                   â”‚
    â”‚                                                              â”‚
    â”‚ positive_count = 5 tin                                       â”‚
    â”‚ negative_count = 1 tin                                       â”‚
    â”‚ neutral_count  = 2 tin                                       â”‚
    â”‚ news_count     = 8 tin                                       â”‚
    â”‚                                                              â”‚
    â”‚ avg_score = (0.78 + 0.65 + 0.82 + 0.55 + 0.70              â”‚
    â”‚              - 0.42 + 0.05 - 0.10) / 8                      â”‚
    â”‚           = 3.03 / 8                                         â”‚
    â”‚           = +0.38                                            â”‚
    â”‚                                                              â”‚
    â”‚ overall_sentiment = 'positive' (vÃ¬ positive_count > negative)â”‚
    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                     â”‚
                     â–¼
    â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—
    â•‘          DATABASE TABLE: sentiment_summary                 â•‘
    â• â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•£
    â•‘ symbolâ”‚ date      â”‚posâ”‚negâ”‚neuâ”‚avg_scoreâ”‚overallâ”‚news_cntâ•‘
    â•‘â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”¼â”€â”€â”€â”¼â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â•‘
    â•‘ VNM   â”‚2024-11-15 â”‚ 5 â”‚ 1 â”‚ 2 â”‚  +0.38  â”‚ pos   â”‚   8    â•‘
    â•‘ HPG   â”‚2024-11-15 â”‚ 2 â”‚ 4 â”‚ 1 â”‚  -0.32  â”‚ neg   â”‚   7    â•‘
    â•‘ VCB   â”‚2024-11-15 â”‚ 3 â”‚ 3 â”‚ 2 â”‚  +0.05  â”‚ neu   â”‚   8    â•‘
    â• â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•£
    â•‘ Columns:                                                   â•‘
    â•‘  â€¢ symbol: MÃ£ cá»• phiáº¿u                                    â•‘
    â•‘  â€¢ date: NgÃ y                                              â•‘
    â•‘  â€¢ positive_count: Sá»‘ tin positive                         â•‘
    â•‘  â€¢ negative_count: Sá»‘ tin negative                         â•‘
    â•‘  â€¢ neutral_count: Sá»‘ tin neutral                           â•‘
    â•‘  â€¢ avg_score: Äiá»ƒm sentiment trung bÃ¬nh (-1 Ä‘áº¿n +1)       â•‘
    â•‘  â€¢ overall_sentiment: Sentiment tá»•ng thá»ƒ (pos/neg/neu)    â•‘
    â•‘  â€¢ news_count: Tá»•ng sá»‘ tin trong ngÃ y                     â•‘
    â•‘  â€¢ updated_at: Thá»i gian cáº­p nháº­t                          â•‘
    â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
                     â”‚
                     â–¼

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ PHASE 5: API ACCESS (Truy váº¥n qua FastAPI)                                 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

    ðŸ“¡ HTTP Request:
    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    â”‚ GET /api/finbert/sentiment/VNM?days=7                      â”‚
    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                     â”‚
                     â–¼
    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    â”‚ FastAPI Endpoint (src/api_v2.py)                           â”‚
    â”‚                                                             â”‚
    â”‚ 1. Query analyzed_news table                               â”‚
    â”‚    WHERE symbol = 'VNM' AND published_at >= NOW() - 7 daysâ”‚
    â”‚                                                             â”‚
    â”‚ 2. Query sentiment_summary table                           â”‚
    â”‚    WHERE symbol = 'VNM' ORDER BY date DESC LIMIT 7        â”‚
    â”‚                                                             â”‚
    â”‚ 3. Calculate statistics:                                    â”‚
    â”‚    - Total positive/negative/neutral counts                â”‚
    â”‚    - Average sentiment score                                â”‚
    â”‚    - Trading recommendation                                 â”‚
    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                     â”‚
                     â–¼
    ðŸ“¥ JSON Response:
    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    â”‚ {                                                           â”‚
    â”‚   "status": "ok",                                           â”‚
    â”‚   "symbol": "VNM",                                          â”‚
    â”‚   "sentiment_summary": {                                    â”‚
    â”‚     "avg_score": 0.38,                                      â”‚
    â”‚     "overall_sentiment": "positive",                        â”‚
    â”‚     "positive_count": 15,                                   â”‚
    â”‚     "negative_count": 3,                                    â”‚
    â”‚     "neutral_count": 5,                                     â”‚
    â”‚     "total_news": 23,                                       â”‚
    â”‚     "recommendation": "ðŸ“ˆ BUY SIGNAL - TÃ­ch cá»±c"           â”‚
    â”‚   },                                                        â”‚
    â”‚   "daily_summary": [                                        â”‚
    â”‚     {                                                       â”‚
    â”‚       "date": "2024-11-15",                                 â”‚
    â”‚       "positive": 5,                                        â”‚
    â”‚       "negative": 1,                                        â”‚
    â”‚       "neutral": 2,                                         â”‚
    â”‚       "avg_score": 0.38,                                    â”‚
    â”‚       "overall": "positive",                                â”‚
    â”‚       "news_count": 8                                       â”‚
    â”‚     },                                                      â”‚
    â”‚     ...                                                     â”‚
    â”‚   ],                                                        â”‚
    â”‚   "recent_news": [...]                                      â”‚
    â”‚ }                                                           â”‚
    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—
â•‘                           TRADING SIGNALS                                    â•‘
â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

    ðŸŽ¯ LOGIC TRADING SIGNAL:
    
    if avg_score > 0.3:
        ðŸ“ˆ BUY SIGNAL - Sentiment tÃ­ch cá»±c máº¡nh
        
    elif avg_score < -0.3:
        ðŸ“‰ SELL SIGNAL - Sentiment tiÃªu cá»±c
        
    elif -0.3 <= avg_score <= 0.3:
        âž¡ï¸ HOLD SIGNAL - Sentiment trung láº­p
    
    
    ðŸ“Š VÃ Dá»¤:
    
    VNM: avg_score = +0.38 â†’ ðŸ“ˆ BUY SIGNAL
    HPG: avg_score = -0.32 â†’ ðŸ“‰ SELL SIGNAL  
    VCB: avg_score = +0.05 â†’ âž¡ï¸ HOLD SIGNAL

â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—
â•‘                        END-TO-END EXAMPLE                                    â•‘
â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

ðŸ“° Input: "Vinamilk bÃ¡o cÃ¡o lá»£i nhuáº­n quÃ½ 3 tÄƒng 25% so vá»›i cÃ¹ng ká»³ nÄƒm trÆ°á»›c"

    â†“ PhoBERT Analysis

ðŸ¤– Sentiment: positive
ðŸ“Š Score: +0.84
ðŸ“ˆ Positive: 0.89 (89%)
ðŸ“‰ Negative: 0.05 (5%)
âž¡ï¸ Neutral: 0.06 (6%)

    â†“ Save to DB

ðŸ’¾ analyzed_news:
   - symbol: VNM
   - sentiment: positive
   - sentiment_score: +0.84

    â†“ Daily Aggregation

ðŸ“Š sentiment_summary (15/11/2024):
   - VNM: 5 pos, 1 neg, 2 neu
   - avg_score: +0.38
   - overall: positive

    â†“ API Query

ðŸŒ GET /api/finbert/sentiment/VNM
   â†’ Response: ðŸ“ˆ BUY SIGNAL - Sentiment tÃ­ch cá»±c

â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—
â•‘                          PERFORMANCE METRICS                                 â•‘
â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

âš¡ Speed:
   â€¢ CPU (Intel i7):         ~2 tin/giÃ¢y
   â€¢ GPU (NVIDIA RTX 3060):  ~10 tin/giÃ¢y

ðŸ’¾ Storage:
   â€¢ analyzed_news:          ~500 bytes/record
   â€¢ sentiment_summary:      ~200 bytes/record
   
ðŸŽ¯ Accuracy:
   â€¢ PhoBERT Vietnamese: ~85% accuracy on Vietnamese financial text
   â€¢ Model: wonrax/phobert-base-vietnamese-sentiment

ðŸ“Š Scalability:
   â€¢ 1000 tin/ngÃ y:     ~2 phÃºt (CPU) / ~30 giÃ¢y (GPU)
   â€¢ 10000 tin/ngÃ y:    ~20 phÃºt (CPU) / ~5 phÃºt (GPU)

"""
    
    print(diagram)


def print_example_code():
    """Print example code for using sentiment analysis"""
    
    code = """
â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—
â•‘                          EXAMPLE CODE USAGE                                  â•‘
â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

1ï¸âƒ£  CHáº Y PHÃ‚N TÃCH OFFLINE (Khuyáº¿n nghá»‹)
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

# KÃ­ch hoáº¡t virtual environment
& D:\\KLTN\\venv\\Scripts\\Activate.ps1

# PhÃ¢n tÃ­ch táº¥t cáº£ tin tá»©c má»›i (7 ngÃ y gáº§n Ä‘Ã¢y)
python scripts/analyze_news_finbert.py

# PhÃ¢n tÃ­ch cho mÃ£ cá»¥ thá»ƒ
python scripts/analyze_news_finbert.py --symbols VNM HPG VCB

# PhÃ¢n tÃ­ch 30 ngÃ y, tá»‘i Ä‘a 200 tin
python scripts/analyze_news_finbert.py --days 30 --limit 200


2ï¸âƒ£  Sá»¬ Dá»¤NG PYTHON MODULE
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

from src.sentiment import FinBERTSentimentAnalyzer

# Initialize analyzer
analyzer = FinBERTSentimentAnalyzer()
analyzer.load_model()

# Analyze single text
text = "Vinamilk bÃ¡o lÃ£i tÄƒng 25%"
result = analyzer.analyze(text)

print(result)
# Output: {
#   'label': 'positive',
#   'score': 0.89,
#   'sentiment_score': 0.84,
#   'method': 'finbert'
# }

# Analyze batch
texts = [
    "VNM tÄƒng trÆ°á»Ÿng máº¡nh",
    "HPG sá»¥t giáº£m doanh thu",
    "VCB á»•n Ä‘á»‹nh"
]
results = analyzer.analyze_batch(texts)


3ï¸âƒ£  TRUY Váº¤N QUA API
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

import requests

# Get sentiment for VNM
response = requests.get(
    "http://localhost:8000/api/finbert/sentiment/VNM",
    params={"days": 7}
)
data = response.json()

print(f"Sentiment: {data['sentiment_summary']['overall_sentiment']}")
print(f"Score: {data['sentiment_summary']['avg_score']}")
print(f"Recommendation: {data['sentiment_summary']['recommendation']}")


4ï¸âƒ£  Káº¾T Há»¢P Vá»šI TECHNICAL INDICATORS
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

from src.features.indicators_processor import IndicatorsProcessor
from src.sentiment import get_analyzer
import pandas as pd

# Get price data
df_price = pd.read_sql("SELECT * FROM stock_prices WHERE symbol='VNM'", engine)

# Calculate technical indicators
processor = IndicatorsProcessor()
df_indicators = processor.calculate_all_indicators(df_price)

# Get sentiment
analyzer = get_analyzer()
sentiment_result = analyzer.analyze("VNM tin tá»©c gáº§n Ä‘Ã¢y...")

# Combine for trading decision
rsi = df_indicators['RSI'].iloc[-1]
sentiment_score = sentiment_result['sentiment_score']

if rsi < 30 and sentiment_score > 0.4:
    signal = "ðŸ”¥ STRONG BUY - Oversold + Tin tá»‘t"
elif rsi > 70 and sentiment_score < -0.4:
    signal = "â›” STRONG SELL - Overbought + Tin xáº¥u"
else:
    signal = "âž¡ï¸ HOLD"

print(signal)


5ï¸âƒ£  QUERY DATABASE TRá»°C TIáº¾P
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

import psycopg2

conn = psycopg2.connect(DATABASE_URL)
cur = conn.cursor()

# Get sentiment summary for VNM
cur.execute(\"\"\"
    SELECT 
        date,
        positive_count,
        negative_count,
        neutral_count,
        avg_score,
        overall_sentiment,
        news_count
    FROM sentiment_summary
    WHERE symbol = 'VNM'
    ORDER BY date DESC
    LIMIT 7
\"\"\")

results = cur.fetchall()
for row in results:
    print(f"{row[0]}: {row[5]} (score: {row[4]:.2f}, news: {row[6]})")

# Output:
# 2024-11-15: positive (score: 0.38, news: 8)
# 2024-11-14: positive (score: 0.25, news: 5)
# ...


6ï¸âƒ£  SCHEDULED DAILY ANALYSIS (APScheduler)
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

from apscheduler.schedulers.background import BackgroundScheduler
import subprocess

def run_sentiment_analysis():
    \"\"\"Run sentiment analysis daily at 18:00\"\"\"
    subprocess.run([
        "python", 
        "scripts/analyze_news_finbert.py",
        "--days", "1"
    ])
    print("âœ… Daily sentiment analysis completed")

# Schedule
scheduler = BackgroundScheduler()
scheduler.add_job(
    run_sentiment_analysis,
    trigger='cron',
    hour=18,
    minute=0,
    day_of_week='mon-fri'
)
scheduler.start()

print("ðŸ“… Scheduled: Daily sentiment analysis at 18:00 (Mon-Fri)")

"""
    
    print(code)


if __name__ == "__main__":
    print_flow_diagram()
    print("\n" * 2)
    print_example_code()
